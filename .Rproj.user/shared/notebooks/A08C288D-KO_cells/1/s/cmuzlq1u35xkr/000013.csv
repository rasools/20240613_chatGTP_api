"0","# Function to query OpenAI API"
"0","chatGPT <- function(prompt, apiKey, modelName = ""gpt-3.5-turbo"", temperature = 1) {"
"0","  response <- POST("
"0","    url = ""https://api.openai.com/v1/chat/completions"","
"0","    add_headers(Authorization = paste(""Bearer"", apiKey)),"
"0","    content_type_json(),"
"0","    encode = ""json"","
"0","    body = list("
"0","      model = modelName,"
"0","      temperature = temperature,"
"0","      messages = list(list(role = ""user"", content = prompt))"
"0","    )"
"0","  )"
"0","  stop_for_status(response)"
"0","  trimws(content(response)$choices[[1]]$message$content)"
"0","}"
"0",""
"0","# Read the list of genes from the Excel file"
"0","path <- ""genes.xlsx""  # Replace with the path to your Excel file"
"0","genes <- read_excel(path, col_names = TRUE)"
"0","genes_list <- as.character(genes[[1]])  # Assumes genes are in the first column"
"0",""
"0","# Initialize a list to store the results"
"0","results <- list()"
"0",""
"0","# Loop through each gene and get knockout cell information"
"0","for (gene in genes_list) {"
"0","  prompt <- paste(""What are the reported knockout cells for the gene"", gene, ""and the titles of the publications?"")"
"0","  response <- chatGPT(prompt, Sys.getenv(""OPENAI_API_KEY_NBIS""))"
"0","  results[[gene]] <- response"
"0","}"
